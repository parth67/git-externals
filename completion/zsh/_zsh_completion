#compdef git-externals

_git_externals() {
    local -a commands externals
    commands=(
        'sync:Sync all externals'
        'add:Add a new external repository'
        'update:Update an external repository'
        'remove:Remove an external repository'
        'list:List all configured externals'
        'help:Show help information'
    )

    # Load externals from the JSON file
    if [[ -f externals.json ]]; then
        externals=($(jq -r '.externals[].name' externals.json 2>/dev/null))
    else
        externals=()
    fi

    _arguments \
        '1:command:->command' \
        '*:args:->args'

    case $state in
        command)
            _describe 'command' commands
            ;;
        args)
            case $words[2] in
                add)
                    _message 'Enter repository name, URL, and path'
                    ;;
                update)
                    _describe 'externals' externals
                    ;;
                remove)
                    _describe 'externals' externals
                    ;;
            esac
            ;;
    esac
}

compdef _git_externals git-externals
